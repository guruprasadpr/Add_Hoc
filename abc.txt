<%@ page import="java.io.*, java.sql.*, java.util.*, java.util.regex.Pattern,java.util.regex.Matcher" %>
<html>
<head>
<title>GPP Dashboard</title>
<style type="text/css">
body {
    background-color:#DCDCDC;
}
h1 {
    color:FloralWhite;
    font-size:25;
    font-family:verandana;
    font-family:arial;
    height:20px;
}
h2 {
    color:FloralWhite;
    font-size:20;
    font-family:verandana;
    font-family:arial;
    height:10px;
}
table {
    color:FloralWhite;
    border:0
}
.layc { 
    background-color:#333333;
    width:900px;
    border-radius:15px;
    padding : 3px;
    float:left
}
.laysep {
    width:100px;
    float:left
}
.nbox {
    height:35;
    width:85px;
}
.cbox {
    height:35;
    width:140px;
}
.csbox {
    height:35;
    width : 120px;
}
.dbox {
    height:35;
    width : 50px;
    color : Black;
}
.mainh1{
    height: 30px;
    padding : 10px;
}
.h1i1{
    height: 10px;
    font-size:25;
    font-family:arial;
    padding : 5px;
    float : left;
    border-radius:5px;
}
.h1i2{
    height: 10px;
    font-size:25;
    font-family:arial;
    padding : 5px;
    float : left;
    border-radius:5px;
}
</style>

</head>
<body>
<div id="header" style="background-color:#333333;border-radius:15px">
<h1 class="mainh1" align="center" > Dashboard</h1>
</div>

<%!
public String getColor(int val){
    if (val == 0){
        return "green";
    }else{
        return "red";
    }
}
public String getQuery(String s1) {
        String qry_file = s1;
        String sql="";
        try{
           FileInputStream f1 = new FileInputStream(qry_file);
           DataInputStream d1 = new DataInputStream(f1);
           String data;
           while((data=d1.readLine()) != null){
               sql += data;
               sql += " ";
           }
           f1.close();
        }
        catch(Exception e){
            System.err.println("Error opening query file");
        }
        return sql;
}

public String[][] getData() throws SQLException{
        //URL of Oracle database server
        String url = "jdbc:oracle:thin:@localhost:1521:XE"; 
        String [][]emparr = new String[5][5];
        int i=0,j=0;
      
        //creating connection to Oracle database using JDBC
        Connection conn = DriverManager.getConnection(url,"guru","aa");


        //creating PreparedStatement object to execute query
        String sql = getQuery("/var/lib/tomcat7/webapps/ROOT/WEB-INF/classes/user/gppquery.sql");
        PreparedStatement preStatement = conn.prepareStatement(sql);
    
        ResultSet result = preStatement.executeQuery();
      
        while(result.next()){
            emparr[i][j]=result.getString(1);
            emparr[i][j+1]=result.getString(2);
            emparr[i][j+2]=result.getString(3);
            emparr[i][j+3]=result.getString(4);
            emparr[i][j+4]=result.getString(5);
            i++;
            //System.out.println("Emp Id : " + result.getString("empno"));
        }
    return emparr;
}
%>

<div id="container" style="width:1200px;">

<div class="laysep" id="menu" >
<h1></h1>
</div>
<! Starting 1st table for bin status -->

<div class="layc" id="box1" >
<TABLE border=1 width="100%">
<tr>
<td width="8%" class="h1i1">BIN</td>
<td width="20%" class="h1i1">TXN Received</td> 
<td width="72%" align="center" class="h1i2">Denial Count</td>
</tr>
</TABLE>
<TABLE border=0 width="100%">
<tr>
<td></td>
<td></td>
<td width="24%" align="center">Late Response </td>
<td width="24%" align="center">Bucket Lock</td>
<td width="24%" align="center"> Other Denials</td>
</tr>
</TABLE>
<hr/>
<TABLE border=0 width="100%">
<%
int REFRESH_DUR=5;
//response.setIntHeader("Refresh", REFRESH_DUR);

String data;
String[][] arr1;
int i=0;
Class.forName("oracle.jdbc.OracleDriver");
try {
    String [][]emparr=getData();
    while(i < emparr.length)
    {
%>
<TR>
<%
        out.println("<td class=\"nbox\">"+ emparr[i][0] + "</td>");
        out.println("<td><input class=\"cbox\" type=\"text\" style=\"background-color:" + getColor(Integer.parseInt(emparr[i][1]))+ ";\" disabled=\"disabled\"/></td>");
        out.println("<td class=\"nbox\" align=\"right\">"+ emparr[i][2] + "</td>");
        out.println("<td ><input class=\"cbox\" type=\"text\" style=\"background-color:" + getColor(Integer.parseInt(emparr[i][2])) + ";\" disabled=\"disabled\"/></td>");
        out.println("<td class=\"nbox\" align=\"right\">"+ emparr[i][3] + "</td>");
        out.println("<td ><input class=\"cbox\" type=\"text\" style=\"background-color:" + getColor(Integer.parseInt(emparr[i][3])) + ";\" disabled=\"disabled\"/></td>");
        out.println("<td class=\"nbox\" align=\"right\">"+ emparr[i][4] + "</td>");
        out.println("<td ><input class=\"cbox\" type=\"text\" style=\"background-color:" + getColor(Integer.parseInt(emparr[i][4])) + ";\" disabled=\"disabled\"/></td>");
%>
</TR>
<%
    i++;
    }
} catch (Exception e) {
    out.println(e.getMessage());
}
%>
</TABLE>
</div>

<div class="laysep" id="menu" >
<h1></h1>
</div>

</div>
</body>
</html>





select 23456, 0,0,0,0 from dual 
union 
select 23457, 0,0,9,0 from dual 
union 
select 23459, 0,0,9,8 from dual 
union 
select 23458, 2,0,0,0 from dual 
union 
select 23454, 0,2,0,0 from dual

